:root{
  color-scheme:dark;
  --motrac-red:#E2001A;
  --motrac-red-600:#c00015;
  --motrac-red-700:#9b0011;
  --aimy-night:#050910;
  --aimy-night-2:#080d1a;
  --aimy-night-3:#0c1324;
  --aimy-glow:rgba(0,231,255,.18);
  --aimy-gold:rgba(200,167,106,.36);
  --ink:#f4f7ff;
  --ink-2:rgba(224,230,255,.88);
  --ink-3:rgba(162,174,204,.78);
  --bg:#050910;
  --card:rgba(12,20,38,.78);
  --card-glass:rgba(10,18,34,.74);
  --muted:rgba(182,198,232,.72);
  --border-subtle:rgba(86,120,190,.32);
  --border-strong:rgba(110,150,214,.36);
  --surface-soft:rgba(10,18,34,.65);
  --ring:rgba(0,231,255,.45);
  --ok:#46d991;
  --warn:#f9a64f;
  --err:#ff7d8d;
  --shadow:0 34px 80px rgba(0,0,0,.55),0 14px 38px rgba(0,0,0,.45);
  --shadow-strong:0 44px 96px rgba(0,0,0,.62),0 18px 48px rgba(0,0,0,.52);
  --radius:18px;
  --app-height:100dvh;
  --app-width:100vw;
  --rood:#A00020;
  --goud:#C8A76A;
  --hemel:#03040a;
  --licht:#F4F5F7;
  --glas:rgba(8,16,32,.78);
  --glas2:rgba(0,231,255,.08);
  --rand:rgba(114,163,255,.32);
  --blur:16px;
  --eio:cubic-bezier(.22,.61,.36,1);
}
*{box-sizing:border-box}
html,body{height:100%}
html{
  scrollbar-gutter:stable both-edges;
  background:var(--bg);
}
body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  color:var(--ink);
  background:
    radial-gradient(120% 120% at 18% 12%, rgba(0,231,255,.16), transparent 60%),
    radial-gradient(95% 85% at 82% 18%, rgba(200,167,106,.16), transparent 70%),
    linear-gradient(180deg, var(--aimy-night-2), var(--aimy-night));
  position:relative;
  transition:color .3s ease, background .5s ease;
}

body.splash{
  min-height:100vh;
  min-height:100dvh;
  min-height:100svh;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

.splash-content{
  position:relative;
  z-index:1;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:2.4rem;
}

.splash-logo{
  width:min(58vw, 320px);
  max-width:100%;
  height:auto;
  filter:drop-shadow(0 24px 48px rgba(3,4,10,.45));
}

body.background-match{
  --ink:var(--ink);
  --ink-2:rgba(224,230,255,.88);
  --ink-3:rgba(158,174,204,.72);
  --bg:var(--aimy-night);
  --card:var(--card);
  --card-glass:rgba(8,16,32,.82);
  --muted:rgba(182,198,232,.7);
  --border-subtle:rgba(86,120,190,.28);
  --border-strong:rgba(126,168,236,.42);
  --surface-soft:rgba(8,16,32,.72);
  --shadow:0 38px 86px rgba(5,9,18,.65),0 18px 42px rgba(5,9,18,.52);
  --shadow-strong:0 48px 110px rgba(5,9,18,.7),0 22px 56px rgba(5,9,18,.58);
  color:var(--ink);
  background:
    radial-gradient(120% 120% at 18% 12%, rgba(0,231,255,.18), transparent 60%),
    radial-gradient(105% 95% at 82% 16%, rgba(200,167,106,.16), transparent 70%),
    linear-gradient(185deg, var(--aimy-night-2), var(--aimy-night));
}

body.background-match.light{
  background:
    radial-gradient(115% 125% at 12% 18%, rgba(0,231,255,.22), transparent 65%),
    radial-gradient(90% 85% at 80% 20%, rgba(200,167,106,.2), transparent 72%),
    linear-gradient(182deg, #091125, #050910 78%);
}

body.background-match::before{
  content:"";
  position:fixed;
  inset:0;
  background:radial-gradient(circle at 52% 46%, rgba(5,21,48,.24), transparent 65%);
  z-index:-4;
  pointer-events:none;
}

body.background-match header{
  background:linear-gradient(180deg, rgba(12,22,44,.9), rgba(6,12,24,.72));
  border-bottom:1px solid var(--rand);
  box-shadow:0 36px 78px rgba(5,9,18,.62);
  backdrop-filter:saturate(1.25) blur(var(--blur));
}

body.background-match .card{backdrop-filter:saturate(1.3) blur(var(--blur));}

body.background-match .logo{
  background:rgba(10,18,34,.82);
  border-color:rgba(126,168,236,.38);
  box-shadow:inset 0 -3px 12px rgba(0,0,0,.4),0 0 28px rgba(0,231,255,.2);
}

body.background-match .btn.secondary{color:var(--ink);}

body.background-match .background-scene{
  position:fixed;
  top:calc(env(safe-area-inset-top, 0px) * -1);
  left:calc(env(safe-area-inset-left, 0px) * -1);
  width:calc(var(--viewport-width, 100vw) + env(safe-area-inset-left, 0px) + env(safe-area-inset-right, 0px));
  height:calc(var(--viewport-height, 100vh) + env(safe-area-inset-top, 0px) + env(safe-area-inset-bottom, 0px));
  min-height:100vh;
  min-height:100dvh;
  min-height:100svh;
  pointer-events:none;
  z-index:-3;
  overflow:hidden;
}

body.background-match .background-scene canvas{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  display:block;
}

body.background-match #neurons{
  z-index:-3;
  opacity:1;
}

body.background-match #protons{
  z-index:-2;
  opacity:1;
}

body.background-match .background-scene .nevel{
  position:absolute;
  inset:-10%;
  z-index:-2;
  mix-blend-mode:screen;
  background:
    radial-gradient(900px 600px at 20% 20%, rgba(200,167,106,.18), transparent 60%),
    radial-gradient(700px 600px at 80% 70%, rgba(0,231,255,.2), transparent 60%);
  opacity:.42;
}

body.background-match .background-scene .raster{
  position:absolute;
  inset:0;
  z-index:-1;
  opacity:.16;
  background-size:80px 80px;
  background-image:
    linear-gradient(var(--glas2) 1px, transparent 1px),
    linear-gradient(90deg, var(--glas2) 1px, transparent 1px);
}

body.background-match .background-scene .pulse{
  position:absolute;
  inset:0;
  margin:auto;
  width:min(64vw,720px);
  aspect-ratio:1;
  border-radius:50%;
  filter:blur(34px);
  pointer-events:none;
  background:radial-gradient(circle, rgba(0,231,255,.22) 0%, transparent 70%);
  animation:pulse 3.2s var(--eio) infinite;
  z-index:-1;
}

@keyframes pulse{
  0%,100%{transform:scale(.96);opacity:.7}
  50%{transform:scale(1.06);opacity:1}
}

@media (prefers-reduced-motion: reduce){
  body.background-match .background-scene .pulse{
    animation:none;
  }
}
body[data-theme="dark"]{
  --ink:#f4f7ff;
  --ink-2:rgba(224,230,255,.9);
  --ink-3:rgba(162,174,204,.76);
  --bg:var(--aimy-night);
  --card:rgba(12,20,38,.82);
  --card-glass:rgba(8,16,32,.82);
  --muted:rgba(182,198,232,.72);
  --border-subtle:rgba(86,120,190,.32);
  --border-strong:rgba(126,168,236,.42);
  --surface-soft:rgba(8,16,32,.7);
  --shadow:0 38px 86px rgba(5,9,18,.65),0 18px 42px rgba(5,9,18,.52);
  --shadow-strong:0 48px 110px rgba(5,9,18,.7),0 22px 56px rgba(5,9,18,.58);
}

body[data-theme="light"]{
  --ink:#f8fbff;
  --ink-2:rgba(224,236,255,.85);
  --ink-3:rgba(174,188,220,.72);
  --bg:#0a1428;
  --card:rgba(18,30,56,.82);
  --card-glass:rgba(12,22,44,.82);
  --muted:rgba(190,206,240,.68);
  --border-subtle:rgba(102,148,214,.32);
  --border-strong:rgba(134,180,244,.4);
  --surface-soft:rgba(12,22,44,.68);
  --shadow:0 34px 80px rgba(6,10,20,.6),0 16px 40px rgba(6,10,20,.5);
  --shadow-strong:0 44px 96px rgba(6,10,20,.64),0 20px 52px rgba(6,10,20,.54);
}

body.chat-page:not(.background-match){
  background:
    radial-gradient(115% 125% at 12% 18%, rgba(0,231,255,.2), transparent 65%),
    radial-gradient(90% 90% at 82% 14%, rgba(200,167,106,.18), transparent 72%),
    linear-gradient(182deg, #091125, #050910 80%);
}
body.chat-page:not(.background-match)::before{
  content:'';
  position:fixed;
  inset:0;
  background-image:radial-gradient(1px 1px at 22px 22px, rgba(0,231,255,.16) 0, rgba(0,231,255,.16) 40%, transparent 40%), radial-gradient(1px 1px at 68px 64px, rgba(200,167,106,.14) 0, rgba(200,167,106,.14) 42%, transparent 42%);
  background-size:140px 140px;
  opacity:.24;
  pointer-events:none;
  z-index:-1;
}
header{
  position:sticky;
  top:0;
  z-index:10;
  backdrop-filter:saturate(1.35) blur(18px);
  background:linear-gradient(180deg, rgba(10,18,34,.9), rgba(6,12,24,.74));
  border-bottom:1px solid rgba(126,168,236,.32);
  box-shadow:0 32px 70px rgba(5,9,18,.58);
}
body.background-match header{
  border-bottom:1px solid var(--rand);
  box-shadow:0 36px 78px rgba(5,9,18,.62);
}
.bar{
  max-width:1200px;
  margin:0 auto;
  padding:18px 24px;
  display:flex;
  align-items:center;
  gap:14px;
  flex-wrap:wrap;
}
.bar > *{min-width:0}
.logo{
  width:48px;
  height:48px;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:6px;
  background:var(--card);
  border:1px solid rgba(126,168,236,.32);
  box-shadow:0 28px 60px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.08);
  overflow:hidden;
  flex-shrink:0;
}

.logo img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}
.headings{display:flex;flex-direction:column;gap:4px;min-width:0;flex:1 1 240px}
.title{font-size:18px;font-weight:750;letter-spacing:.2px;line-height:1.2}
.sub{font-size:13px;color:var(--muted)}

.wrap{
  max-width:1240px;
  margin:32px auto 48px;
  padding:0 24px 72px;
  display:grid;
  grid-template-columns:minmax(260px,320px) minmax(0,1fr);
  gap:24px;
  align-items:start;
}
@media (max-width: 980px){
  .wrap{grid-template-columns:1fr;padding:0 20px 56px;margin:24px auto 48px}
  .side{order:2}
}

.card{
  background:var(--card);
  border:1px solid var(--border-strong);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  backdrop-filter:saturate(1.25) blur(var(--blur));
}
body.chat-page .card{
  background:var(--card-glass);
  border:1px solid rgba(126,168,236,.34);
  backdrop-filter:saturate(1.2) blur(18px);
  box-shadow:var(--shadow-strong);
}
body[data-theme="dark"].chat-page .card{border-color:rgba(126,168,236,.34);}

.side{display:flex;flex-direction:column;gap:14px}
body.chat-page .side{position:sticky;top:120px;align-self:start}
@media (max-width: 980px){
  body.chat-page .side{position:static}
}

.panel{padding:14px}
body.chat-page .panel{padding:20px 22px}
.panel h3{margin:0 0 10px;font-size:14px;text-transform:uppercase;letter-spacing:.08em;color:var(--ink)}
.hint{font-size:12px;color:var(--muted)}

.upload{
  border:1px dashed rgba(126,168,236,.34);
  border-radius:12px;
  padding:14px;
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:center;
  text-align:center;
  cursor:pointer;
  background:rgba(8,16,32,.6);
  box-shadow:0 24px 56px rgba(0,0,0,.42);
}
.upload:hover{border-color:rgba(0,231,255,.45)}
.upload input{display:none}

.doc-list{
  display:flex;
  flex-direction:column;
  gap:8px;
  max-height:220px;
  overflow:auto;
  padding-right:4px;
}
.doc{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px;
  border:1px solid rgba(126,168,236,.32);
  border-radius:12px;
}
.doc .dot{width:9px;height:9px;border-radius:99px;background:rgba(0,231,255,.85);box-shadow:0 0 12px rgba(0,231,255,.5)}
.doc .meta{flex:1}
.doc .name{font-size:13px;font-weight:600}
.doc .small{font-size:12px;color:var(--muted)}
.doc button{
  border:none;
  background:transparent;
  color:rgba(0,231,255,.82);
  font-weight:600;
  cursor:pointer;
}

.precheck{display:flex;flex-direction:column;gap:14px}
.precheck .field{display:flex;flex-direction:column;gap:6px}
.precheck label{font-size:13px;font-weight:600;color:var(--ink)}
.precheck .field.invalid label{color:var(--err)}
.precheck .error{display:none;color:var(--err)}
.precheck .field.invalid .error{display:block}
.precheck .field.invalid .input{border-color:var(--err)}
.precheck .field.invalid .input:focus{box-shadow:0 0 0 3px rgba(185,28,28,.35)}
.precheck-status{margin:0;padding:10px;border-radius:10px;background:var(--surface-soft);border:1px solid var(--border-subtle)}
.precheck-status.ok{border-color:rgba(0,231,255,.45);background:rgba(0,231,255,.1)}

.prechat-page{
  min-height:var(--app-height, 100dvh);
  display:flex;
  flex-direction:column;
  background:transparent;
}
.prechat-top{
  display:flex;
  width:100%;
  max-width:560px;
  padding:32px 22px 18px;
  margin:0 auto;
  align-items:flex-start;
}
.prechat-top .logo{width:60px;height:60px;padding:8px}
.prechat-branding{display:flex;flex-direction:column;gap:6px}
.prechat-suptitle{font-size:12px;text-transform:uppercase;letter-spacing:.18em;color:rgba(144,176,220,.76)}
.prechat-title{margin:0;font-size:26px;letter-spacing:.06em;color:var(--ink)}
.prechat-sub{margin:0;font-size:14px;color:var(--muted);line-height:1.5}
.prechat-container{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:12px 18px 24px;
}
.prechat-card{
  width:100%;
  max-width:520px;
  display:flex;
  flex-direction:column;
  gap:18px;
}
.prechat-header{display:flex;gap:14px;align-items:center}
.prechat-header .logo{flex-shrink:0}
.prechat-titles{display:flex;flex-direction:column;gap:4px}
.prechat-titles h2{margin:0;font-size:20px;letter-spacing:.04em}
.prechat-actions{display:grid;grid-template-columns:repeat(2, minmax(0,1fr));gap:10px}
.prechat-actions .btn{min-height:48px}
.prechat-benefits{margin:0;padding:0;list-style:none;display:flex;flex-direction:column;gap:6px;font-size:12px;color:var(--muted)}
.prechat-benefits li{display:flex;align-items:center;gap:8px}
.prechat-benefits li::before{content:'✓';color:rgba(0,231,255,.82);font-weight:700}
.prechat-footnote{margin:0;color:var(--muted);line-height:1.5}
.history-page .wrap{display:block}
.history-layout{
  max-width:1100px;
  margin:24px auto 32px;
  padding:0 18px;
  display:flex;
  flex-direction:column;
  gap:18px;
}
.history-controls{display:flex;flex-direction:column;gap:14px}
.history-controls h1{margin:0;font-size:24px;letter-spacing:.02em}
.history-search{display:flex;align-items:center;gap:12px}
.history-search .input{flex:1}
.history-columns{
  display:grid;
  gap:18px;
  grid-template-columns:repeat(auto-fit, minmax(320px, 1fr));
}
.history-section{display:flex;flex-direction:column;gap:14px}
.history-section-header{display:flex;align-items:center;justify-content:space-between;gap:12px}
.history-section-header h2{margin:0;font-size:18px}
.history-list{display:flex;flex-direction:column;gap:12px}
.history-empty{margin:0}
.history-item{display:flex;flex-direction:column;gap:12px}
.history-item-header{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
.history-item-title{margin:0;font-size:18px;line-height:1.3;word-break:break-word}
.history-item-meta{white-space:nowrap}
.history-item-tags{display:flex;flex-wrap:wrap;gap:8px}
.history-item-preview{
  margin:0;
  font-size:13px;
  color:var(--ink-3);
  line-height:1.5;
  display:-webkit-box;
  -webkit-line-clamp:3;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
.history-item-actions{display:flex;flex-wrap:wrap;gap:8px}
.history-item-actions .history-delete{
  color:var(--err);
  border-color:rgba(185,28,28,.35);
  background:rgba(185,28,28,.08);
}
.history-item-actions .history-delete:hover{
  background:rgba(185,28,28,.12);
}
body[data-theme="dark"] .history-item-actions .history-delete{
  border-color:rgba(185,28,28,.45);
  background:rgba(185,28,28,.18);
  color:var(--err);
}
@media (max-width: 720px){
  .bar{padding:16px 18px;gap:12px;align-items:flex-start}
  .bar .logo{order:1}
  .headings{order:2;width:100%}
  .right{order:3;width:100%;justify-content:flex-start;gap:8px}
  .right .btn{flex:1 1 140px;justify-content:center}
  .prechat-top{padding:20px 18px 14px}
  .prechat-branding{gap:8px}
  .prechat-title{font-size:24px}
  .prechat-container{padding:18px 18px 32px;align-items:flex-start}
  .prechat-card{gap:16px}
  .prechat-actions{grid-template-columns:1fr}
  .prechat-footer{padding:18px 16px 28px}
  .prechat-quick-actions{flex-direction:column;max-width:100%}
  .theme-toggle{right:16px;bottom:16px;padding:10px 14px;font-size:13px}
  .history-controls h1{font-size:22px}
  .history-item-title{font-size:17px}
  .history-section-header{flex-direction:column;align-items:flex-start}
  .history-item-header{flex-direction:column;align-items:flex-start}
  .history-item-meta{white-space:normal}
  .chat-toolbar{align-items:flex-start;flex-direction:column;gap:16px}
  .chat-toolbar-meta{gap:4px}
  body.chat-page .composer{flex-direction:column;align-items:stretch}
  body.chat-page .composer textarea{width:100%}
  body.chat-page .composer .btn{width:100%;justify-content:center;min-height:56px}
}
.prechat-footer{
  padding:18px;
  text-align:center;
  display:flex;
  flex-direction:column;
  gap:6px;
  align-items:center;
}
.prechat-quick-actions{
  margin-top:6px;
  display:flex;
  gap:12px;
  width:100%;
  max-width:420px;
}
.ios-button{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  padding:14px 18px;
  border-radius:18px;
  border:1px solid rgba(126,168,236,.38);
  background:linear-gradient(180deg, rgba(16,26,48,.92), rgba(10,18,34,.85));
  box-shadow:0 28px 60px rgba(0,0,0,.48), inset 0 1px 0 rgba(255,255,255,.06);
  font-size:14px;
  font-weight:600;
  color:var(--ink);
  text-decoration:none;
  transition:transform .16s ease, box-shadow .18s ease, background .18s ease;
}
.ios-button:focus-visible{
  outline:3px solid rgba(0,231,255,.28);
  outline-offset:3px;
}
.ios-button:hover{
  transform:translateY(-1px);
  box-shadow:0 34px 72px rgba(0,0,0,.56), inset 0 1px 0 rgba(255,255,255,.12);
}
.ios-button:active{
  transform:translateY(0);
  background:linear-gradient(180deg, rgba(12,22,44,.9), rgba(8,16,32,.84));
  box-shadow:0 20px 40px rgba(0,0,0,.42) inset;
}
@media (max-width: 520px){
  .prechat-quick-actions{flex-direction:column;align-items:stretch}
}

.prechat-summary{display:flex;flex-direction:column;gap:14px}
.summary-list{margin:0;display:flex;flex-direction:column;gap:12px}
.summary-row{display:flex;justify-content:space-between;align-items:flex-start;gap:16px;padding:12px 14px;border-radius:16px;border:1px solid rgba(126,168,236,.32);background:rgba(12,20,38,.78);box-shadow:0 26px 60px rgba(0,0,0,.42);backdrop-filter:blur(16px) saturate(128%)}
.summary-row dt{font-size:11px;text-transform:uppercase;letter-spacing:.12em;color:var(--muted)}
.summary-row dd{margin:0;font-weight:650;color:var(--ink)}
.summary-row dd.empty{color:var(--muted);font-weight:500}
body[data-theme="dark"].chat-page .summary-row{background:rgba(12,20,38,.78);border-color:rgba(126,168,236,.32);box-shadow:0 32px 70px rgba(0,0,0,.5)}

.btn.full{width:100%;justify-content:center}

.chat{
  position:relative;
  display:flex;
  flex-direction:column;
  min-height:min(520px, var(--app-height, 100dvh));
  height:calc(var(--app-height, 100dvh) - 150px);
  overflow:hidden;
}
body.chat-page .chat::after{
  content:'';
  position:absolute;
  inset:auto 0 0;
  height:120px;
  background:linear-gradient(180deg, rgba(5,9,18,0), rgba(5,9,18,.82));
  pointer-events:none;
  z-index:0;
}
body[data-theme="dark"].chat-page .chat::after{background:linear-gradient(180deg, rgba(5,9,18,0), rgba(5,9,18,.88));}
.chat-toolbar{
  position:relative;
  z-index:1;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  padding:18px 22px 12px;
  border-bottom:1px solid rgba(126,168,236,.28);
}
body[data-theme="dark"].chat-page .chat-toolbar{border-bottom:1px solid rgba(126,168,236,.28)}
.chat-toolbar-meta{display:flex;flex-direction:column;gap:6px}
.chat-toolbar-title{margin:0;font-size:18px;letter-spacing:.03em;color:var(--ink)}
.chat-toolbar-sub{margin:0;font-size:13px;color:var(--muted);max-width:420px;line-height:1.5}
.messages{
  position:relative;
  z-index:1;
  flex:1;
  overflow:auto;
  padding:22px;
  display:flex;
  flex-direction:column;
  gap:18px;
  scroll-padding:24px;
}
body.chat-page .messages{
  background:linear-gradient(180deg, rgba(14,24,46,.82), rgba(8,16,32,.9));
}
body[data-theme="dark"].chat-page .messages{background:linear-gradient(180deg, rgba(12,22,44,.85), rgba(6,12,24,.92));}
.bubble{
  --bubble-bg:rgba(12,20,38,.85);
  --bubble-border:rgba(126,168,236,.38);
  --bubble-shadow:0 32px 68px rgba(0,0,0,.56);
  max-width:860px;
  padding:18px 20px;
  border-radius:18px;
  border:1px solid var(--bubble-border);
  background:var(--bubble-bg);
  box-shadow:var(--bubble-shadow);
  position:relative;
  backdrop-filter:saturate(1.05);
}
.bubble.assistant::before,
.bubble.user::before{
  content:'';
  position:absolute;
  inset:-12px;
  border-radius:inherit;
  opacity:.6;
  pointer-events:none;
  z-index:-1;
}
.bubble.assistant::before{background:radial-gradient(320px circle at 40px 20px, rgba(0,231,255,.16), transparent 70%);}
.bubble.user::before{background:radial-gradient(320px circle at calc(100% - 40px) 20px, rgba(200,167,106,.18), transparent 70%);}
.bubble.assistant{
  --bubble-bg:linear-gradient(170deg, rgba(18,30,56,.94), rgba(12,22,44,.88));
  --bubble-border:rgba(0,231,255,.38);
  --bubble-shadow:0 36px 74px rgba(0,231,255,.28);
}
.bubble.assistant.loading .content{
  display:flex;
  align-items:center;
  min-height:56px;
}
.bubble.assistant.loading .role{margin-bottom:10px}
.bubble.user{
  align-self:flex-end;
  --bubble-bg:linear-gradient(160deg, rgba(20,30,58,.92), rgba(16,20,44,.88));
  --bubble-border:rgba(200,167,106,.4);
  --bubble-shadow:0 36px 74px rgba(200,167,106,.26);
}
.forklift-loader{
  display:flex;
  align-items:center;
  gap:12px;
  width:100%;
  font-size:12px;
  color:var(--muted);
}
.forklift-scene{
  position:relative;
  width:96px;
  height:44px;
}
.forklift-track{
  position:absolute;
  left:0;
  right:0;
  bottom:4px;
  height:6px;
  border-radius:999px;
  background:linear-gradient(180deg,#d1d5db,#cbd0d6);
  opacity:.7;
}
.forklift-move{
  position:absolute;
  left:4px;
  bottom:8px;
  width:88px;
  height:36px;
  animation:forklift-drive 2.6s ease-in-out infinite alternate;
}
.forklift-body{
  position:absolute;
  bottom:6px;
  left:12px;
  width:36px;
  height:22px;
  background:var(--motrac-red);
  border-radius:8px 8px 4px 4px;
  box-shadow:inset 0 -4px 0 rgba(0,0,0,.18);
}
.forklift-cabin{
  position:absolute;
  top:-12px;
  left:6px;
  width:18px;
  height:12px;
  border-radius:4px 4px 0 0;
  background:#fff;
  box-shadow:0 2px 0 rgba(0,0,0,.1);
}
.forklift-wheel{
  position:absolute;
  bottom:-8px;
  width:14px;
  height:14px;
  border-radius:50%;
  background:#111;
  box-shadow:inset 0 0 0 3px #2f2f2f,inset 0 0 0 6px #555;
  animation:forklift-wheel 1s linear infinite;
}
.forklift-wheel::before{
  content:'';
  position:absolute;
  inset:3px;
  border-radius:inherit;
  border:2px solid rgba(255,255,255,.35);
}
.forklift-wheel.front{left:-8px}
.forklift-wheel.back{right:-8px}
.forklift-mast{
  position:absolute;
  top:-6px;
  right:-10px;
  width:6px;
  height:28px;
  border-radius:3px;
  background:#2f3134;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.08);
}
.forklift-fork{
  position:absolute;
  bottom:-8px;
  left:-18px;
  width:32px;
  height:5px;
  border-radius:4px;
  background:#45474b;
  box-shadow:0 -3px 0 rgba(255,255,255,.08);
}
.forklift-box{
  position:absolute;
  bottom:18px;
  left:60px;
  width:22px;
  height:22px;
  border-radius:4px;
  background:#fcd34d;
  box-shadow:inset 0 -5px 0 rgba(0,0,0,.18);
}
.forklift-box::after{
  content:'';
  position:absolute;
  inset:6px 5px 8px;
  border-radius:2px;
  background:rgba(0,0,0,.12);
}
.loader-text{flex:1;line-height:1.4}
@keyframes forklift-drive{
  from{transform:translateX(0)}
  to{transform:translateX(26px)}
}
@keyframes forklift-wheel{
  from{transform:rotate(0)}
  to{transform:rotate(360deg)}
}
@media (prefers-reduced-motion: reduce){
  .forklift-move,
  .forklift-wheel{
    animation:none;
  }
}
.bubble .role{
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size:11px;
  letter-spacing:.14em;
  text-transform:uppercase;
  color:var(--muted);
  margin-bottom:10px;
  padding:5px 12px;
  border-radius:999px;
  background:rgba(148,163,184,.16);
  font-weight:650;
}
.bubble.assistant .role{color:rgba(0,231,255,.88);background:rgba(0,231,255,.16)}
.bubble.user .role{color:rgba(200,167,106,.85);background:rgba(200,167,106,.16)}
body[data-theme="dark"].chat-page .bubble .role{background:rgba(148,163,184,.16);color:var(--muted)}
body[data-theme="dark"].chat-page .bubble.assistant .role{color:rgba(0,231,255,.88);background:rgba(0,231,255,.2)}
body[data-theme="dark"].chat-page .bubble.user .role{color:rgba(200,167,106,.85);background:rgba(200,167,106,.2)}
.bubble .content{
  white-space:pre-wrap;
  line-height:1.6;
  font-size:15px;
  color:var(--ink-2);
}
body[data-theme="dark"].chat-page .bubble .content{color:var(--ink-2)}

.composer{
  position:relative;
  z-index:1;
  padding:18px 22px 22px;
  border-top:1px solid rgba(126,168,236,.28);
  background:linear-gradient(180deg, rgba(14,26,50,.9), rgba(6,12,24,.95));
  display:flex;
  gap:14px;
  align-items:flex-end;
}
body[data-theme="dark"].chat-page .composer{border-top:1px solid rgba(126,168,236,.28);background:linear-gradient(180deg, rgba(12,24,46,.92), rgba(5,10,20,.96));}
.composer textarea{
  flex:1;
  resize:vertical;
  max-height:220px;
  min-height:56px;
  padding:14px 16px;
  border:1px solid rgba(126,168,236,.32);
  border-radius:16px;
  font:inherit;
  line-height:1.5;
  box-shadow:inset 0 1px 0 rgba(0,231,255,.12);
  background:rgba(8,16,32,.82);
  color:var(--ink);
  transition:border-color .2s ease, box-shadow .2s ease, background-color .2s ease;
}
body[data-theme="dark"].chat-page .composer textarea{border-color:rgba(126,168,236,.32);background:rgba(6,12,24,.86);box-shadow:inset 0 1px 0 rgba(0,231,255,.1);}
.composer textarea::placeholder{color:rgba(158,174,204,.64)}
body[data-theme="dark"].chat-page .composer textarea::placeholder{color:rgba(158,174,204,.64)}
.composer textarea:focus{
  outline:none;
  border-color:rgba(0,231,255,.55);
  box-shadow:0 0 0 3px var(--ring);
  background:rgba(10,18,34,.94);
}
body[data-theme="dark"].chat-page .composer textarea:focus{background:rgba(8,16,32,.94);}
.btn{
  position:relative;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  padding:12px 18px;
  border-radius:18px;
  border:1px solid rgba(126,168,236,.32);
  background:linear-gradient(170deg, rgba(16,26,48,.92), rgba(10,18,34,.86));
  box-shadow:0 28px 60px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.08);
  color:var(--ink);
  font-weight:650;
  font-size:14px;
  letter-spacing:.01em;
  cursor:pointer;
  text-decoration:none;
  transition:transform .18s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}
.btn:hover:not(:disabled){
  transform:translateY(-1px);
  box-shadow:0 36px 76px rgba(0,0,0,.58), inset 0 1px 0 rgba(255,255,255,.12);
}
.btn:active:not(:disabled){
  transform:translateY(0);
  background:linear-gradient(170deg, rgba(12,22,44,.92), rgba(8,16,32,.88));
  box-shadow:0 18px 42px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.08);
}
.btn:focus-visible{
  outline:3px solid rgba(0,231,255,.3);
  outline-offset:3px;
}
.btn:disabled{
  opacity:.55;
  cursor:not-allowed;
  box-shadow:none;
  transform:none;
}
.btn.primary{
  background:linear-gradient(135deg, rgba(128,176,255,.96), rgba(72,220,255,.96));
  border-color:rgba(114,163,255,.78);
  color:var(--ink);
  text-shadow:0 1px 4px rgba(0,0,0,.32);
  box-shadow:0 32px 70px rgba(72,180,255,.42), inset 0 1px 0 rgba(255,255,255,.22);
}
.btn.primary:hover:not(:disabled){
  box-shadow:0 38px 84px rgba(72,180,255,.48), inset 0 1px 0 rgba(255,255,255,.28);
}
.btn.primary:active:not(:disabled){
  background:linear-gradient(135deg, rgba(112,168,255,.94), rgba(54,196,252,.94));
  box-shadow:0 26px 62px rgba(72,180,255,.38), inset 0 1px 0 rgba(255,255,255,.2);
}
.btn.secondary{
  color:var(--ink);
  background:linear-gradient(170deg, rgba(16,26,48,.92), rgba(10,18,34,.86));
  border-color:rgba(126,168,236,.32);
}
.btn.secondary:hover:not(:disabled){
  border-color:rgba(138,182,252,.42);
}
.btn.small{
  padding:10px 14px;
  font-size:13px;
  border-radius:14px;
}
.btn.icon{
  padding:0;
  width:48px;
  height:48px;
  justify-content:center;
  border-radius:16px;
}
.btn.icon svg{width:20px;height:20px}
body.chat-page .composer .btn{
  min-height:56px;
  padding:0 28px;
  border-radius:22px;
  font-size:15px;
  letter-spacing:.01em;
  box-shadow:0 34px 76px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.1);
}
body.chat-page .composer .btn.primary{
  box-shadow:0 40px 90px rgba(72,180,255,.42), inset 0 1px 0 rgba(255,255,255,.22);
}
body.chat-page .composer .btn.primary:hover:not(:disabled){
  box-shadow:0 48px 112px rgba(72,180,255,.5), inset 0 1px 0 rgba(255,255,255,.28);
}
body.chat-page .composer .btn:active:not(:disabled){
  transform:translateY(0);
  box-shadow:0 22px 52px rgba(0,0,0,.46), inset 0 1px 0 rgba(255,255,255,.14);
}
body[data-theme="dark"].chat-page .composer .btn{box-shadow:0 34px 76px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.1);}
body[data-theme="dark"].chat-page .composer .btn.primary{box-shadow:0 40px 90px rgba(72,180,255,.42), inset 0 1px 0 rgba(255,255,255,.22);}
body[data-theme="dark"].chat-page .composer .btn.primary:hover:not(:disabled){box-shadow:0 48px 112px rgba(72,180,255,.5), inset 0 1px 0 rgba(255,255,255,.28);}
body.chat-page .chat-toolbar .btn.secondary.icon{
  background:linear-gradient(170deg, rgba(16,26,48,.92), rgba(10,18,34,.86));
  border-color:rgba(126,168,236,.34);
  box-shadow:0 30px 68px rgba(0,0,0,.52), inset 0 1px 0 rgba(255,255,255,.1);
}
body.chat-page .chat-toolbar .btn.secondary.icon:hover:not(:disabled){
  box-shadow:0 40px 90px rgba(0,0,0,.6), inset 0 1px 0 rgba(255,255,255,.16);
}
body[data-theme="dark"].chat-page .chat-toolbar .btn.secondary.icon{background:linear-gradient(170deg, rgba(16,26,48,.92), rgba(10,18,34,.86));border-color:rgba(126,168,236,.34);box-shadow:0 30px 68px rgba(0,0,0,.52), inset 0 1px 0 rgba(255,255,255,.1);}
.sr-only{
  position:absolute;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  white-space:nowrap;
  border:0;
}

.row{display:flex;gap:8px;align-items:center}
.grow{flex:1}
.sep{height:1px;background:var(--border-subtle);margin:10px 0}

.badge{
  font-size:11px;
  padding:3px 8px;
  border-radius:999px;
  border:1px solid rgba(126,168,236,.34);
  background:rgba(12,20,38,.78);
  white-space:nowrap;
}
body.chat-page .badge{
  background:rgba(12,20,38,.78);
  border-color:rgba(126,168,236,.34);
  box-shadow:0 28px 60px rgba(0,0,0,.45);
}
body[data-theme="dark"].chat-page .badge{background:rgba(12,20,38,.78);border-color:rgba(126,168,236,.34);box-shadow:0 28px 60px rgba(0,0,0,.45);}
.status.ok{color:var(--ok)}
.status.warn{color:var(--warn)}
.status.err{color:var(--err)}

.input{
  font:inherit;
  border:1px solid var(--border-strong);
  border-radius:10px;
  padding:6px 8px;
  background:var(--card);
  color:inherit;
  min-width:0;
}
.input:focus{
  outline:none;
  border-color:rgba(0,231,255,.55);
  box-shadow:0 0 0 3px var(--ring);
}

.tiny{font-size:11px;color:var(--muted)}
.right{
  margin-left:auto;
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:10px;
  flex-wrap:wrap;
}

.modal{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
  background:rgba(11,13,15,.45);
  z-index:50;
}
.modal[aria-hidden="true"]{display:none}
.modal-card{max-width:420px;width:100%;position:relative}
.modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.settings-body{display:flex;flex-direction:column;gap:10px}
.settings-section{display:flex;flex-direction:column;gap:10px}
.settings-section h4{margin:0;font-size:13px;font-weight:700;letter-spacing:.04em;text-transform:uppercase;color:var(--ink)}
.settings-list{margin:6px 0 0 16px;padding:0 0 0 4px;display:flex;flex-direction:column;gap:4px}

.theme-toggle{
  position:fixed;
  right:24px;
  bottom:24px;
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:12px 16px;
  border-radius:999px;
  border:1px solid rgba(126,168,236,.38);
  background:linear-gradient(170deg, rgba(16,26,48,.92), rgba(10,18,34,.86));
  color:var(--ink);
  font-weight:650;
  font-size:14px;
  cursor:pointer;
  box-shadow:0 36px 78px rgba(0,0,0,.52), inset 0 1px 0 rgba(255,255,255,.1);
  transition:transform .2s ease, box-shadow .2s ease, background-color .3s ease, color .3s ease;
  z-index:20;
}
.theme-toggle:hover{transform:translateY(-2px);box-shadow:0 46px 102px rgba(0,0,0,.6), inset 0 1px 0 rgba(255,255,255,.16);}
.theme-toggle:focus-visible{outline:none;box-shadow:0 0 0 4px var(--ring);}

body[data-theme="dark"] .card,
body[data-theme="dark"] .tag,
body[data-theme="dark"] .doc,
body[data-theme="dark"] .bubble,
body[data-theme="dark"] .badge,
body[data-theme="dark"] .input,
body[data-theme="dark"] .composer textarea,
body[data-theme="dark"] .upload,
body[data-theme="dark"] .theme-toggle{
  background:var(--surface-soft);
}
body[data-theme="dark"] .card{box-shadow:var(--shadow);}
body[data-theme="dark"] .tag:hover{background:rgba(20,30,54,.72);}
body[data-theme="dark"] .bubble.assistant{border-color:rgba(0,231,255,.4);background:linear-gradient(170deg, rgba(18,30,56,.94), rgba(12,22,44,.88));}
body[data-theme="dark"] .bubble.user{border-color:rgba(200,167,106,.42);background:linear-gradient(170deg, rgba(20,30,58,.92), rgba(16,20,44,.88));}
body[data-theme="dark"] .theme-toggle{box-shadow:0 36px 78px rgba(0,0,0,.52);}
body[data-theme="dark"] .theme-toggle:hover{box-shadow:0 46px 102px rgba(0,0,0,.6);}

body.background-match .theme-toggle{background:linear-gradient(170deg, rgba(16,26,48,.92), rgba(10,18,34,.86));border-color:rgba(126,168,236,.38);box-shadow:0 36px 78px rgba(0,0,0,.52), inset 0 1px 0 rgba(255,255,255,.1);}
body.background-match .theme-toggle:hover{box-shadow:0 46px 102px rgba(0,0,0,.6), inset 0 1px 0 rgba(255,255,255,.16);}
body.background-match .theme-toggle:focus-visible{box-shadow:0 0 0 4px rgba(0,231,255,.3);}

@media (max-width: 600px){
  .theme-toggle{right:16px;bottom:16px;padding:11px 14px;font-size:13px}
}

@media (max-width: 900px){
  .title{font-size:17px}
}

@media (max-width: 720px){
  .bar{padding:12px 16px}
  .right{
    margin-left:0;
    width:100%;
    justify-content:flex-start;
    gap:8px;
  }
  .headings{flex:1}
  .title{font-size:16px}
  .sub{font-size:12px}
}

@media (max-width: 600px){
  .wrap{margin:12px auto;padding:0 12px}
  .bar{gap:10px}
  .logo{width:40px;height:40px;padding:5px}
  .chat{height:auto;min-height:65vh}
  .messages{padding:12px}
  .composer{flex-direction:column;align-items:stretch}
  .composer textarea{min-height:110px;width:100%;flex:auto}
  .composer .btn{width:100%;justify-content:center}
  .side{order:2}
  .prechat-top{padding:18px 16px 8px}
  .prechat-title{font-size:22px}
  .prechat-sub{font-size:13px}
  .prechat-container{padding:0 16px 18px}
  .prechat-actions{grid-template-columns:1fr;gap:8px}
  .prechat-actions .btn{min-height:52px}
  .prechat-card{gap:16px}
  .prechat-footer{padding:16px 14px 22px}
}

@media (max-width: 480px){
  .badge{font-size:10px;padding:3px 6px}
  .btn.small{padding:8px 12px;font-size:12px;border-radius:12px}
  .title{font-size:15px}
  .sub{font-size:11px}
  .wrap{padding:0 10px}
  .prechat-title{font-size:20px}
  .prechat-sub{font-size:12px}
  .prechat-branding{gap:4px}
}
